{% macro render_card(title, body, buttons, columns=1, embedding=None) %}
{% if columns == 3 %}
    {% set width = "col-12 col-md-12 col-lg-12" %}
{% elif columns == 2 %}
    {% set width = "col-12 col-md-6 col-lg-6" %}
{% else %}
    {% set width = "col-12 col-md-6 col-lg-4" %}
{% endif %}
<div class="{{ width }}">
    {% set has_body = body is defined and body %}
    {% set button_count = buttons|length %}
    {% set action_class = "" %}
    {% if columns > 0 %}
        {% set action_class = "me-auto" %}
    {% endif %}
    {% if not has_body and button_count == 1 and not embedding %}
        {% set btn = buttons[0] %}
        <a href="{{ btn.target }}" target="_blank" rel="noopener noreferrer"
           class="btn {{ btn.css_class if btn.css_class is defined else 'btn btn-outline-primary' }} d-flex align-items-center w-100 {{ action_class }}">
            <i class="bi bi-{{ btn.icon }} me-2"></i>
            {{ title }}
        </a>
    {% else %}
        <div class="card h-100">
            <div class="card-header">
                {{ title }}
            </div>
            <div class="card-body d-flex flex-column">
                {% if has_body %}
                    <div class="mb-3">
                        {{ body }}
                    </div>
                {% endif %}
                <div class="mt-auto d-flex flex-column gap-2 flex-wrap {{ action_class }}">
                    {% for btn in buttons %}
                        <a href="{{ btn.target }}" target="_blank" rel="noopener noreferrer"
                           class="btn {{ btn.css_class if btn.css_class is defined else 'btn-outline-primary' }} d-flex align-items-center text-start">
                            <i class="bi bi-{{ btn.icon }} me-2"></i>
                            {{ btn.text }}
                        </a>
                    {% endfor %}
                    {% if embedding %}
                        {% set acc_id = "embedAccordion" ~ loop.index if loop is defined else "embedAccordion" %}
                        <div class="accordion" id="{{ acc_id }}">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="{{ acc_id }}-heading">
                                    <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#{{ acc_id }}-collapse"
                                            aria-expanded="false"
                                            aria-controls="{{ acc_id }}-collapse">
                                        <i class="bi bi-input-cursor-text me-2"></i>
                                        {{ embedding.title }}
                                    </button>
                                </h2>
                                <div id="{{ acc_id }}-collapse" class="accordion-collapse collapse"
                                     aria-labelledby="{{ acc_id }}-heading"
                                     data-bs-parent="#{{ acc_id }}">
                                    <div class="accordion-body px-0 pt-0 pb-0">
                                        <iframe src="{{ embedding.embed_url }}" width="100%" height="800px"
                                                class="embedding-content"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endmacro %}
